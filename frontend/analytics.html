<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics - Digital Twin</title>
    <link rel="stylesheet" href="./css/styles.css">
    <link rel="stylesheet" href="./css/components.css">
    <link rel="stylesheet" href="./css/dashboard.css">
    <link rel="stylesheet" href="./css/charts.css">
    <link rel="stylesheet" href="./css/responsive.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="theme-ocean">
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <i class="fas fa-heartbeat"></i>
                <span>Digital Twin</span>
            </div>
            <div class="nav-menu">
                <a href="index.html" class="nav-link">Home</a>
                <a href="manual-entry.html" class="nav-link">Data Entry</a>
                <a href="dashboard.html" class="nav-link">Dashboard</a>
                <a href="profile.html" class="nav-link">Profile</a>
                <a href="analytics.html" class="nav-link active">Analytics</a>
                <a href="about.html" class="nav-link">About</a>
            </div>
        </div>
    </nav>

    <div class="page-container">
        <div class="container">
            <div class="analytics-header">
                <h1><i class="fas fa-chart-line"></i> Advanced Analytics</h1>
                <p>Deep insights into your health patterns and trends</p>
            </div>

            <!-- Filter Controls -->
            <div class="analytics-controls">
                <div class="control-group">
                    <label for="timeRange">Time Range</label>
                    <select id="timeRange" class="form-control">
                        <option value="7">Last 7 days</option>
                        <option value="30" selected>Last 30 days</option>
                        <option value="90">Last 90 days</option>
                        <option value="365">Last year</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="dataType">Data Type</label>
                    <select id="dataType" class="form-control">
                        <option value="all" selected>All Data</option>
                        <option value="vitals">Vitals Only</option>
                        <option value="lifestyle">Lifestyle Only</option>
                        <option value="academic">Academic Only</option>
                    </select>
                </div>
                <div class="control-group">
                    <button class="btn btn-primary" onClick="updateAnalytics()">
                        <i class="fas fa-sync-alt"></i> Update
                    </button>
                </div>
            </div>

            <!-- Analytics Grid -->
            <div class="analytics-grid">
                <!-- Correlation Analysis -->
                <div class="analytics-card large">
                    <div class="card-header">
                        <h3><i class="fas fa-project-diagram"></i> Health Correlations</h3>
                        <div class="card-actions">
                            <button class="btn-icon" title="Export Chart">
                                <i class="fas fa-download"></i>
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <canvas id="correlationChart"></canvas>
                    </div>
                </div>

                <!-- Trend Analysis -->
                <div class="analytics-card large">
                    <div class="card-header">
                        <h3><i class="fas fa-trending-up"></i> Health Score Trends</h3>
                        <div class="card-actions">
                            <select class="form-control" id="trendMetric">
                                <option value="health_score">Health Score</option>
                                <option value="sleep_quality">Sleep Quality</option>
                                <option value="stress_level">Stress Level</option>
                                <option value="academic_performance">Academic Performance</option>
                            </select>
                        </div>
                    </div>
                    <div class="card-body">
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>

                <!-- Risk Assessment -->
                <div class="analytics-card">
                    <div class="card-header">
                        <h3><i class="fas fa-shield-alt"></i> Risk Assessment</h3>
                    </div>
                    <div class="card-body">
                        <div class="risk-breakdown">
                            <div class="risk-item">
                                <div class="risk-label">Overall Risk</div>
                                <div class="risk-bar">
                                    <div class="risk-fill low" style="width: 25%"></div>
                                </div>
                                <div class="risk-value">Low (25%)</div>
                            </div>
                            <div class="risk-item">
                                <div class="risk-label">Health Risk</div>
                                <div class="risk-bar">
                                    <div class="risk-fill low" style="width: 15%"></div>
                                </div>
                                <div class="risk-value">Low (15%)</div>
                            </div>
                            <div class="risk-item">
                                <div class="risk-label">Stress Risk</div>
                                <div class="risk-bar">
                                    <div class="risk-fill medium" style="width: 35%"></div>
                                </div>
                                <div class="risk-value">Medium (35%)</div>
                            </div>
                            <div class="risk-item">
                                <div class="risk-label">Academic Risk</div>
                                <div class="risk-bar">
                                    <div class="risk-fill low" style="width: 20%"></div>
                                </div>
                                <div class="risk-value">Low (20%)</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Insights -->
                <div class="analytics-card">
                    <div class="card-header">
                        <h3><i class="fas fa-lightbulb"></i> AI Insights</h3>
                    </div>
                    <div class="card-body">
                        <div class="insights-list">
                            <div class="insight-item positive">
                                <i class="fas fa-check-circle"></i>
                                <div class="insight-content">
                                    <h4>Sleep Pattern Improvement</h4>
                                    <p>Your sleep quality has improved by 15% over the last month.</p>
                                </div>
                            </div>
                            <div class="insight-item warning">
                                <i class="fas fa-exclamation-triangle"></i>
                                <div class="insight-content">
                                    <h4>Stress Level Concern</h4>
                                    <p>Stress levels have increased during exam periods. Consider stress management techniques.</p>
                                </div>
                            </div>
                            <div class="insight-item info">
                                <i class="fas fa-info-circle"></i>
                                <div class="insight-content">
                                    <h4>Exercise Correlation</h4>
                                    <p>Higher physical activity correlates with better mood ratings and academic focus.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Data Quality -->
                <div class="analytics-card">
                    <div class="card-header">
                        <h3><i class="fas fa-database"></i> Data Quality</h3>
                    </div>
                    <div class="card-body">
                        <div class="quality-metrics">
                            <div class="quality-item">
                                <div class="quality-label">Completeness</div>
                                <div class="quality-bar">
                                    <div class="quality-fill" style="width: 85%"></div>
                                </div>
                                <div class="quality-value">85%</div>
                            </div>
                            <div class="quality-item">
                                <div class="quality-label">Consistency</div>
                                <div class="quality-bar">
                                    <div class="quality-fill" style="width: 92%"></div>
                                </div>
                                <div class="quality-value">92%</div>
                            </div>
                            <div class="quality-item">
                                <div class="quality-label">Recency</div>
                                <div class="quality-bar">
                                    <div class="quality-fill" style="width: 98%"></div>
                                </div>
                                <div class="quality-value">98%</div>
                            </div>
                        </div>

                        <div class="data-summary">
                            <p><strong>Total Records:</strong> 156</p>
                            <p><strong>Last Entry:</strong> Today, 2:30 PM</p>
                            <p><strong>Data Streak:</strong> 7 days</p>
                        </div>
                    </div>
                </div>

                <!-- Export Options -->
                <div class="analytics-card">
                    <div class="card-header">
                        <h3><i class="fas fa-file-export"></i> Export Data</h3>
                    </div>
                    <div class="card-body">
                        <div class="export-options">
                            <button class="btn btn-outline" onclick="exportData('csv')">
                                <i class="fas fa-file-csv"></i> Export CSV
                            </button>
                            <button class="btn btn-outline" onclick="exportData('json')">
                                <i class="fas fa-file-code"></i> Export JSON
                            </button>
                            <button class="btn btn-outline" onclick="exportData('pdf')">
                                <i class="fas fa-file-pdf"></i> Export PDF Report
                            </button>
                        </div>

                        <div class="export-settings">
                            <div class="form-check">
                                <input type="checkbox" id="includeVitals" checked>
                                <label for="includeVitals">Include Vitals</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" id="includeLifestyle" checked>
                                <label for="includeLifestyle">Include Lifestyle</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" id="includeAcademic" checked>
                                <label for="includeAcademic">Include Academic</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="./js/main.js"></script>
    <script src="./js/charts.js"></script>
    <script src="./js/data-manager.js"></script>
    <script>
        // Initialize analytics
        document.addEventListener('DOMContentLoaded', function() {
            initializeAnalyticsCharts();
        });

        function initializeAnalyticsCharts() {
            // Correlation Chart
            const correlationCtx = document.getElementById('correlationChart').getContext('2d');
            new Chart(correlationCtx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Sleep vs Stress',
                        data: [
                            {x: 6, y: 8}, {x: 7, y: 6}, {x: 8, y: 4}, {x: 7.5, y: 5},
                            {x: 6.5, y: 7}, {x: 8.5, y: 3}, {x: 7, y: 6}, {x: 8, y: 4}
                        ],
                        backgroundColor: 'rgba(59, 130, 246, 0.6)',
                        borderColor: 'rgb(59, 130, 246)',
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: {
                            title: { display: true, text: 'Sleep Hours' }
                        },
                        y: {
                            title: { display: true, text: 'Stress Level' }
                        }
                    }
                }
            });

            // Trend Chart
            const trendCtx = document.getElementById('trendChart').getContext('2d');
            new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                    datasets: [{
                        label: 'Health Score',
                        data: [72, 75, 78, 78],
                        borderColor: 'rgb(16, 185, 129)',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        function updateAnalytics() {
            DigitalTwinApp.showToast('Analytics updated successfully!', 'success');
        }

        function exportData(format) {
            DigitalTwinApp.showToast(`Exporting data as ${format.toUpperCase()}...`, 'info');
        }
    </script>
</body>
</html>